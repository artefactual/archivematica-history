

Notes to get started:
install the dependancies. & python
edit the client and server to load local archivematica config file.
edit the archivematica config file locations to represent where they are located on your machine (replace /home/joseph/archivematica...)

to use the sample config:
create /tmp/tmp/ /tmp/tmp2/ /tmp/tmp3/
run the server(MCP)
run the client 
Move a folder, containing files to the /tmp/tmp directory, and you should see a hello world for each of the files.

The server may have a problem with watch folder .IN_CREATED 
if it does, switch the commented line, and it should work.

errors in moving the folder tend to crash the server (no try catch implemented yet)



I was thinking of the following folder structure for watched folders:
watchFolders
    Scan with AV
        Clam AV
    identify file type
        FITS
    normalize

shared folder: 
  archivematicaConfigs - link to /etc/archivematica/
  /.processing/

Quarantine lock will need to be released by the dashboard. - as a system automated time approval.


dependancies:
sudo apt-get install python-twisted
sudo apt-get install python-pyinotify
archivematica Load Config


stdout and stderr should be relative to folder path /objects/
^disable "../" on client side <evil people>

FAQ
why not just allow the server to run whatever command it wants on the clients?
Security. 
The client needs to maintain a list of functions it can do, so we aren't really losing anything by ensuring that the server informs the client to do something on the list.

Your protocol is kinda ugly and relies on \r\n.
Yes. You're perfectly welcome to fix it.




TODO:
%% replacement dics
no ../ in output files
output to output files
no `command` in arguments - use a script
no && or || in arguments - use a script
change tasksLock to be job.jobLock()?
load the folders that are in the watched folders when MCP loads.
test filter to commands (so they only operate on a folder (subfolders y/n), and extentions .doc .log .etc. [for cleanup purposes]
remove identifier from commands - use exec to identify.

add logging of task started/stopped:
client
command
startTime
endTime
exitCode
fileUUID
SIPUUID
relativeFilePath (/objects/...)

add logging of 
user approved?
client connected/disconnected.

Note: no clean way to disconnect atm.

add create a copy of original sip
restore copy of original sip - in dashboard.
delete copy made.

log set name.

add does file exist (ret 0/1)

add digiatally sign files?
spelling of archivematicaVars


MD5 checks need to return number of fails

return error code when client fails to write to file






